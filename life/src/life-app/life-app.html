<html><head><meta charset="UTF-8"><link rel="import" href="../app-shell/app-shell.html"></head><body><dom-module id="life-app">
  <template>
    <app-drawer-layout force-narrow="">
      <app-drawer swipe-ope="">
        <app-header fixed="">
          <app-toolbar>
            <div main-title="">All Patterns</div>
          </app-toolbar>
        </app-header>
        <paper-listbox style="height: 100%; overflow: auto" selected="0">
          <template is="dom-repeat" items="{{app._catalog}}">
            <paper-item on-tap="_handlePatternListTap" style="justify-content: space-between">
              {{item.name}}
              <life-icon-toggle pressed="{{item.starred}}"></life-icon-toggle>
            </paper-item>
          </template>
        </paper-listbox>
      </app-drawer>

      <app-drawer id="endDrawer" align="end" swipe-open="">
        <paper-tabs id="tabs" selected="{{_tab}}">
          <paper-tab name="starredPatterns">Star</paper-tab>
          <paper-tab name="canvasSaves">Saves</paper-tab>
        </paper-tabs>

        <iron-pages selected="[[_tab]]" class="flex">
          <div id="starredPatterns">
            <paper-listbox style="height: 100%; overflow: auto" selected="0">
              <template is="dom-repeat" items="{{app._catalog}}" filter="_isPatternStarred" observe="starred">
                <paper-item on-tap="_handlePatternListTap" style="justify-content: space-between">
                  {{item.name}}
                  <life-icon-toggle pressed="{{item.starred}}"></life-icon-toggle>
                </paper-item>
              </template>
            </paper-listbox>
          </div>
          <div id="canvasSaves">
            <paper-button on-tap="_handleCreateNewSave" style="width: 100%; text-transform: none; justify-content: flex-start; margin-right: 4px">
              <iron-icon icon="add" item-icon=""></iron-icon>
              New
            </paper-button>
            
            <paper-listbox id="savesList" style="height: 100%; overflow: auto">
              
              <template is="dom-repeat" items="{{app.saves}}" id="repeater">
                
                <paper-item on-tap="_handleSaveListTap" style="justify-content: space-between">
                  <span>[[item.title]]</span>
                  <div>
                    <paper-icon-button icon="info" on-tap="_handleInfoViewForSave">
                    </paper-icon-button>

                    
                    
                  </div>
                </paper-item>
                
              </template>
            </paper-listbox>
          </div>
        </iron-pages>
      </app-drawer>

      <app-header-layout>
        <app-header style="height: 96px" fixed="">
          <app-toolbar>
            <paper-icon-button icon="menu" drawer-toggle=""></paper-icon-button>
            <div main-title="">Game of Life</div>
            <paper-icon-button icon="settings" onclick="document.getElementById('settingsDialog').open();"></paper-icon-button>
            <paper-icon-button icon="star" onclick="document.getElementById('endDrawer').toggle();"></paper-icon-button>
          </app-toolbar>
        </app-header>
      </app-header-layout>



      <div style="float: left; padding: 0 8px">
        <div>
          
          <life-save-dialog id="infoViewDialog" target="{{app._selectedSave}}" on-title-change="_handleTitleChange"></life-save-dialog>
          <life-settings-dialog id="settingsDialog" app="{{app}}"></life-settings-dialog>
          <life-canvas id="mainCanvas" width="{{app.width}}" height="{{app.height}}" is-playing="{{app.controller.isPlaying}}" refresh-rate="{{app.controller.refreshRate}}" cell-size="{{app.cellSize}}" cell-color="{{app.cellColor}}" overlay-color="{{app.overlayColor}}" background-color="{{app.backgroundColor}}" brush="{{app._selectedPattern}}">
          </life-canvas>
          <life-brush-editor stamps="[[app._selectedPattern]]" brush="{{app._selectedPattern}}" app="{{app}}"></life-brush-editor>

          <nav>
            <paper-button id="togglecontroller" on-tap="_togglePlaying" toggles="" style="float: left">Pause</paper-button>
            <paper-slider value="{{app.controller.refreshRate}}" min="20" max="300" editable="" style="float: left; min-width: 300px"></paper-slider>
            
            <paper-button id="clearcontroller" on-tap="handleClear" toggles="" style="float: left">Clear</paper-button>
          </nav>
        </div>
        

        
      </div>


      <iron-ajax auto="" url="../../patterns-lite.json" handle-as="json" on-response="handleResponse"></iron-ajax>
    </app-drawer-layout>
  </template>


  <style>
    app-toolbar {
      /* Toolbar is the main header, so give it some color */
      background-color: #1E88E5;
      font-family: 'Roboto', Helvetica, sans-serif;
      color: white;
      --app-toolbar-font-size: 20px;
    }
    app-header-layout {
      z-index: 10;
    }
    app-drawer {
      z-index: 11;
    }
    paper-tabs {
      --paper-tabs-selection-bar-color: #304ffe;
    }
    paper-tab {
      --paper-tab-ink: #304ffe;
    }
  </style>

  <script>Polymer({is:"life-app",properties:{app:{type:Object},params:{type:Object,observer:"_onParamsChanged"},_tab:{type:Number,value:0},_selectedSavesIndex:{type:Number,value:0},_selectingSaveInfo:{type:Object,notify:!0,value:{}}},ready:function(){},_onParamsChanged:function(e){if(this.params.state&&("playing"===this.params.state?this._startPlaying():"paused"===this.params.state&&this._stopPlaying()),this.params.data){var t=this.$.mainCanvas;t.clearCanvas(),t.injectPattern(0,0,this.params.data)}},_startPlaying:function(){this.$.togglecontroller.textContent="Pause",this.set("app.controller.isPlaying",!0)},_stopPlaying:function(){this.$.togglecontroller.textContent="Resume",this.set("app.controller.isPlaying",!1)},_isPlaying:function(){return this.get("app.controller.isPlaying")},_togglePlaying:function(){this._isPlaying()?this._stopPlaying():this._startPlaying()},handleClear:function(e,t){this.$.mainCanvas.clearCanvas()},handleResponse:function(e){this.app._catalog=[{id:"pencil",name:"Pencil",payload:["1"],meta:{x:1,y:1}},{id:"glider",name:"Glider",payload:["010","001","111"],meta:{x:3,y:3}},{id:"light_weight_spaceship",name:"Light Weight Spaceship",payload:["01001","10000","10001","11110"],meta:{x:5,y:4}},{id:"glider_gun",name:"Glider Gun",payload:["000000000000000000000000100000000000","000000000000000000000010100000000000","000000000000110000001100000000000011","000000000001000100001100000000000011","110000000010000010001100000000000000","110000000010001011000010100000000000","000000000010000010000000100000000000","000000000001000100000000000000000000","000000000000110000000000000000000000"],meta:{x:36,y:9}}].concat(e.detail.response),this.app._catalog.forEach(function(e){e.starred=!1}),this.notifyPath("app._catalog"),this.set("app._selectedPattern",this.app._catalog[0])},_handleCreateNewSave:function(){var e=this.$.mainCanvas,t=e.getRLE(),a=e.getCanvasDataURL(),i=new Date,s=("0"+i.getHours()).slice(-2)+":"+("0"+i.getMinutes()).slice(-2)+":"+("0"+i.getHours()).slice(-2);this.push("app.saves",{title:s,rle:t,dataUrl:a,shareUrl:"http://kumassy.com/life/?state=paused&data="+t,createdAt:new Date,updatedAt:new Date})},_handleSaveListTap:function(e){this.app._selectedSave=e.model.get("item")},_handlePatternListTap:function(e){this.set("app._selectedPattern",e.model.get("item"))},_handleInfoViewForSave:function(e){this.set("app._selectedSave",e.model.get("item")),this.set("app._selectedSaveIndex",e.model.get("index")),this.$.endDrawer.toggle(),this.$.infoViewDialog.open()},_handleTitleChange:function(e){this.app&&this.app.hasOwnProperty("_selectedSaveIndex")&&this.notifyPath(["app","saves",this.app._selectedSaveIndex,"title"])},_isPatternStarred:function(e){return e.starred}});</script>
</dom-module>
</body></html>